version: 2

models:
  - name: mart_claims_summary
    description: |
      Monthly claims summary mart aggregating key metrics by line of business,
      claim type, and status. Used for executive dashboards and claims analytics.

      Grain: One row per service_month, line_of_business, claim_type, claim_status combination.

    columns:
      - name: summary_key
        description: "Surrogate key for the summary record"
        tests:
          - not_null
          - unique

      - name: service_month
        description: "First day of the service month"
        tests:
          - not_null

      - name: year_month
        description: "Year-month in YYYY-MM format"
        tests:
          - not_null

      - name: line_of_business
        description: "Line of business (Commercial, Medicare, Medicaid, etc.)"

      - name: claim_type
        description: "Type of claim (Institutional, Professional)"

      - name: claim_count
        description: "Total number of claims"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0

      - name: unique_members
        description: "Count of distinct members with claims"
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0

      - name: total_paid
        description: "Total amount paid"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0

      - name: approval_rate
        description: "Percentage of claims approved"
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              max_value: 100

      - name: avg_days_to_process
        description: "Average days from receipt to processing"
